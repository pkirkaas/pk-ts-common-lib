"use strict";const p=e=>typeof e=="object"&&e!=null&&!(e instanceof Boolean)&&!(e instanceof Date)&&!(e instanceof Number)&&!(e instanceof RegExp)&&!(e instanceof String),l=e=>"#"+e.map(t=>String(t).replace(/~/g,"~0").replace(/\//g,"~1")).join("/"),g=()=>{const e=new exports.WeakMap;return function(n,s){if(n!=="$ref"&&p(s)){if(e.has(s))return{$ref:l(e.get(s))};e.set(s,[...e.get(this)??[],n])}return s}};function h(){const e=new exports.WeakMap,t=new exports.WeakMap,n=new exports.Set;function s(i){const c=i.$ref.slice(1).split("/");let r,o,f=this;for(var a=0;a<c.length;a++)r=c[a].replace(/~1/g,"/").replace(/~0/g,"~"),f=f[r];o=e.get(i),o[t.get(i)]=f}return function(c,r){if(c==="$ref")n.add(this);else if(p(r)){var o=c===""&&Object.keys(this).length===1;o?n.forEach(s,this):(e.set(r,this),t.set(r,c))}return r}}const d=e=>Object.defineProperties(e,{decycle:{value:(t,n)=>e.stringify(t,g(),n)},retrocycle:{value:t=>e.parse(t,h())}});Object.assign(exports,{decycle:g,retrocycle:h,extend:d});
